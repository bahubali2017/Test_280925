ğŸ› ï¸ Agent Prompt â€” Stop AI Permanent Fix

Goal: Implement full cancellation support so that pressing Stop AI immediately halts response generation both client- and server-side, preserving partial content and preventing wasted credits.

Tasks:
	1.	Frontend (client/src/lib/llm-api.jsx + ChatPage.jsx):
	â€¢	Add AbortController per streaming request.
	â€¢	In handleStopAI, call both:
    controller.abort();
fetch(`/api/chat/cancel/${sessionId}`, { method: "POST" });

â€¢	Update error handling in handleStreamingResponseSSE:
	â€¢	Treat AbortError as cancellation (status = "stopped"), not failure.
	â€¢	Preserve partial content.
	â€¢	Ensure stopped messages are excluded from prepareConversationHistory.

	2.	Backend (server/routes.js):
	â€¢	Add activeSessions map to track ongoing AI calls.
	â€¢	Store AbortController when starting AI generation.
	â€¢	Pass controller.signal to OpenAI/DeepSeek client.
	â€¢	New route:
    app.post("/api/chat/cancel/:sessionId", (req, res) => {
  const controller = activeSessions.get(req.params.sessionId);
  if (controller) {
    controller.abort();
    activeSessions.delete(req.params.sessionId);
    return res.json({ success: true, cancelled: true });
  }
  res.json({ success: false, cancelled: false });
});

	â€¢	Add req.on("close") â†’ trigger abort for safety.
	3.	Testing Checklist:
	â€¢	Start AI response â†’ press Stop AI:
	â€¢	âœ… Generation halts immediately (server + client).
	â€¢	âœ… Message status stays "stopped by user".
	â€¢	âœ… Partial response visible.
	â€¢	âœ… No API credits wasted.
	â€¢	Ask new question:
	â€¢	âœ… Clean response (no ghost tokens).
	â€¢	âœ… Validation errors gone.
    
ğŸš€ Strict Rules
	â€¢	No extra features.
	â€¢	No experimental logic.
	â€¢	No service worker, cache, or version checks.
	â€¢	Focus ONLY on Stop AI cancel protocol (client + server).
    â€¢ Remove and delete previous reductent testing scripts
    
Expected Outcome:
	â€¢	AI stops instantly on Stop AI.
	â€¢	No more â€œfailedâ€ status spam.
	â€¢	No wasted credits from ghost generations.
	â€¢	Smooth multi-turn conversations with reliable cancel support.